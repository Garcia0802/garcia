<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>validador de cpf</title>
</head>
<body>
    <input type="text" id="cpf" placeholder="Digite seu CPF"> 


    <button id="calcular" onclick="validarCPF()">Validar</button>
    <p id="resultado"></p>

    <script>

        function formatarCPF(cpf) {
            // Adiciona pontos e traço no padrão XXX.XXX.XXX-XX
            return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4");
        }

        function validarCPF() {
            let cpf = document.getElementById("cpf").value;
            let resultado = document.getElementById("resultado");

            // Remove caracteres não numéricos
            cpf = cpf.replace(/\D/g, '');

            // Verifica se o CPF tem 11 dígitos
            if (cpf.length !== 11) {
                resultado.innerHTML = "CPF inválido. Deve conter 11 dígitos.";
                return;
            }

            // Verifica se todos os dígitos são iguais
            if (/^(\d)\1{10}$/.test(cpf)) {
                resultado.innerHTML = "CPF inválido. Todos os dígitos são iguais.";
                return;
            }

            // Validação do CPF
            let soma = 0;
            let peso = 10;

            for (let i = 0; i < 9; i++) {
                soma += parseInt(cpf[i]) * peso--;
            }

            let primeiroDigitoVerificador = (soma * 10) % 11;
            if (primeiroDigitoVerificador === 10) primeiroDigitoVerificador = 0;

            if (parseInt(cpf[9]) !== primeiroDigitoVerificador) {
                resultado.innerHTML = "CPF inválido.";
                return;
            }

            soma = 0;
            peso = 11;

            for (let i = 0; i < 10; i++) {
                soma += parseInt(cpf[i]) * peso--;
            }

            let segundoDigitoVerificador = (soma * 10) % 11;
            if (segundoDigitoVerificador === 10) segundoDigitoVerificador = 0;

            if (parseInt(cpf[10]) !== segundoDigitoVerificador) {
                resultado.innerHTML = "CPF inválido.";
                return;
            }

            resultado.innerHTML = `CPF válido! (${formatarCPF(cpf)})`;
        }

        let inputCPF = document.getElementById("cpf");

        inputCPF.addEventListener('input', function() {
            let valor = inputCPF.value.replace(/\D/g, '');
            if (valor.length > 11) valor = valor.slice(0, 11);
            let formatado = valor;
            if (valor.length > 9) {
                formatado = valor.replace(/(\d{3})(\d{3})(\d{3})(\d{1,2})/, "$1.$2.$3-$4");
            } else if (valor.length > 6) {
                formatado = valor.replace(/(\d{3})(\d{3})(\d{1,3})/, "$1.$2.$3");
            } else if (valor.length > 3) {
                formatado = valor.replace(/(\d{3})(\d{1,3})/, "$1.$2");
            }
            inputCPF.value = formatado;
        });

    </script>
    
</body>

</html>